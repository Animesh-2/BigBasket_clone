<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="Styles/index.css">
    <style>
        h1{
            text-align:left;
            margin-left:135px;
            margin-top:50px;

        }

        

        #products div img {
            height: 80px;
            width:80px;
            margin-left: 50px;
            border: 1px solid gainsboro;
            border-radius: 10px;
           
        }

        #products div p {
            font-size: large;
           

        }

         .productPri {
             text-align:left;
             width:130px;
        }

        .productNam {
            
            width:100px;
            margin-left:20px;


        } 

        #checkout {
            box-shadow: rgb(96 96 96/ 16%) 4px 4px 4px 4px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, var(--bg-opacity));
            height: 80px;
            background-color: rgb(41, 39, 39);
            color: white;
            width: 80%;
            margin: auto;
            padding: 1%;
        }

        #savings {
            color: rgb(23, 200, 23);
            margin-left: 1%;

        }

       

        .ckbutton {
            position:absolute;
            right:170px;
            top:150px;
            width: 200px;
            height: 40px;
            background-color: red;
            color: white;
            border-radius: 5px;
            border:none;

           
        }
  
        

        #prodN {
            display:flex;
            justify-content: space-around;
            width:80%;
            margin:auto;
            font-size:larger;

        }

        .leftPrice {
           
            margin-right:-40px;
            font-weight: bolder;

        }

         .rightName{

            
            margin-left:5px;
            width:150px;
            margin-left:-70px;
            font-weight: bolder;
        } 

        .qty{
            font-weight: bolder;


        }

        #cartElements{
            display:flex;
            justify-content: space-evenly;
            width:80%;
            margin:auto;
            height:100px;
            box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;
            margin-top:5px;
            
        
        }

        #inc{
            width:30px;
            height:15px;
            padding:5px;
            margin:auto;
            /* border:1px solid red; */
            
        }


        #remove{
            /* border:1px solid red; */
            margin-left:30px;
            margin-right: 20px;
            height:100%;
            cursor: pointer;
            
        }


        
        


    </style>
</head>

<body>
    
    <h1>Your Basket</h1>
    <div id="checkout"></div>
    <div id="prodN">

        <p class="rightName">Product Name</p>
        <p class="qty">Quantity</p>
        <p class="leftPrice">Price</p>
    </div>
    <div id="products"></div>
   
</body>

<script>
    
    
    


    // 1. get the data from localstorage
    let data = [
       
    {
            name: "Tea 1kg",
            price: "305.45",
            mPrice: "354",
            img: "https://www.bigbasket.com/media/uploads/p/m/20005452_3-organic-india-organic-tulsi-green-tea-pomegranate-stress-relieving.jpg",
        },
        {
            name: "Pepsi Black",
            price: "135",
            mPrice: "151",
            img: "https://www.bigbasket.com/media/uploads/p/m/1200615_2-pepsi-black-soft-drink-max-taste-zero-caldiet.jpg",
        },
        {
            name: "Coconut Water",
            price: "513",
            img: "https://www.bigbasket.com/media/uploads/p/m/1206997_2-coconut-water-with-no-added-sugar.jpg",
        },

    ];
        let string = JSON.stringify(data)
        localStorage.setItem("cart", string)


    let parent = document.getElementById("products")

    let cart = JSON.parse(localStorage.getItem("cart"));
    // console.log("cart");
    // let alimul = document.getElementById("bask");
    // alimul.innerText = cart.length + " Items";
    function showProducts() {

        cart.forEach(function (product) {
            // console.log(product.name);


            let div = document.createElement("div");
            div.setAttribute("id","cartElements");

            let img = document.createElement("img");
            img.src = product.img;



            let product_price = document.createElement("p");
            product_price.textContent = "₹" + product.price;

            let qty = document.createElement("input");
            qty.setAttribute("type", "number");
            qty.setAttribute("id","inc");
            qty.placeholder = "1";



            let product_name = document.createElement("p");
            product_name.setAttribute("class", "productNam")
            product_price.setAttribute("class", "productPri")
            product_name.textContent = product.name;

            let remove = document.createElement("p");
            remove.textContent = "╳";
            remove.setAttribute("id","remove");



            div.append(img, product_name, qty, product_price, remove);

            parent.append(div);

        });

    };


    let totalAmount = 0;
    let totalItems = 0;
    for (var i = 0; i < cart.length; i++) {
        totalAmount = totalAmount + Number(cart[i].price);
        totalItems++;
    }

    var sum = document.getElementById("checkout");
    let ite = document.createElement("p");
    ite.setAttribute("id", "cos")
    ite.innerText = "Subtotal (" + totalItems + " items): ₹" + Math.floor(totalAmount);
    let am = document.createElement("p");
    am.setAttribute("id", "savings")
    am.innerText = "Savings: ₹" + totalAmount * 0.25;

    let pr = document.createElement("p");
    pr.innerText = "Enter Promo-code";

    let promo = document.createElement("input");
    promo.placeholder = "Enter Promo-code";

    let final = document.createElement("button");
    final.innerText = "Validate";

    final.addEventListener("click", updateValue)

    let ckbtn = document.createElement("button");
    ckbtn.innerText = "Checkout";
    ckbtn.setAttribute("class", "ckbutton");
    ckbtn.addEventListener("click", succ)

    var ght = 0;

    function updateValue() {
        var promoCode = promo.value;
        if (ght === 0 && promoCode == "Bigbasket30") {
            totalAmount = 0.70 * totalAmount;
            alert("Congrats you have got 30% discount.")
            promo.style.color = "green";
            promo.value = "Promocode Applied!!";
            final.innerText = "Applied";
            ght++;
        } else if (promoCode != "Bigbasket30") {
            alert("Invalid Promocode. Try again!");
            promo.value = "";
        }
        ite.innerText = "Subtotal (" + totalItems + " items): ₹" + Math.floor(totalAmount);


    }
    sum.append(ite, am,ckbtn);

    showProducts();

    function succ() {
        window.location.href = "payment.html";
    }


</script>

</html>